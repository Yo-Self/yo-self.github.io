name: Test Simple Telegram Notification

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Test notification
        run: |
          echo "🧪 Testando notificação do Telegram..."
          echo "📱 Chat ID: ${{ secrets.TELEGRAM_CHAT_ID }}"
          echo "🔑 Bot Token: ${TELEGRAM_BOT_TOKEN:0:10}..."
      
      - name: Send test notification
        run: |
          curl -X POST \
            "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "${{ secrets.TELEGRAM_CHAT_ID }}",
              "message_thread_id": 2,
              "text": "🧪 **Teste de Notificação**\n\n✅ Esta mensagem deve aparecer na aba CI/CD\n\n🔧 Teste realizado via workflow simples\n\n⏰ Data: $(date)",
              "parse_mode": "Markdown"
            }'
        
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      
      - name: Verify response
        run: |
          echo "✅ Teste concluído!"
          echo "📱 Verifique se a mensagem apareceu na aba CI/CD do supergrupo"
