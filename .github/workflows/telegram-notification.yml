name: Telegram Notification

on:
  workflow_call:
    inputs:
      message:
        description: 'Mensagem para enviar no Telegram'
        required: true
        type: string
      status:
        description: 'Status do workflow (success, failure, cancelled)'
        required: true
        type: string
      workflow_name:
        description: 'Nome do workflow que executou'
        required: true
        type: string
      run_url:
        description: 'URL da execuÃ§Ã£o do workflow'
        required: true
        type: string
      branch:
        description: 'Branch que foi executada'
        required: false
        type: string
        default: 'main'

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Telegram notification
        uses: appleboy/telegram-action@v0.0.9
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            ğŸ¤– **GitHub Actions - ${{ inputs.workflow_name }}**
            
            ğŸ“‹ **Status:** ${{ inputs.status == 'success' && 'âœ… Sucesso' || inputs.status == 'failure' && 'âŒ Falha' || 'âš ï¸ Cancelado' }}
            
            ğŸŒ¿ **Branch:** ${{ inputs.branch }}
            
            ğŸ“ **Detalhes:** ${{ inputs.message }}
            
            ğŸ”— **Ver execuÃ§Ã£o:** [${{ inputs.workflow_name }}](${{ inputs.run_url }})
            
            â° **Executado em:** ${{ format('dd/MM/yyyy HH:mm:ss', 'UTC') }}
